# Прогнозирование стоимости жилья в Калифорнии (1990)

## О проекте

Проект представляет собой решение задачи регрессии по прогнозированию медианной стоимости домов в жилых массивах Калифорнии на основе данных переписи населения 1990 года. Реализован с использованием Apache Spark и PySpark для обработки больших данных и построения моделей машинного обучения.

### Бизнес-контекст:

Анализ рынка недвижимости Калифорнии для поддержки принятия решений в сфере:

- Оценки стоимости недвижимости для риелторов и агентств
- Определения перспективных районов для инвестиций
- Оценки залоговой стоимости для банковского сектора
- Планирования развития районов муниципалитетами

## Цели проекта

1. **Прогностическая**: Построить точную модель для предсказания стоимости жилья
2. **Аналитическая**: Исследовать факторы, влияющие на стоимость недвижимости
3. **Сравнительная**: Сопоставить разные подходы к построению моделей
4. **Практическая**: Разработать инструмент для автоматизированной оценки стоимости

###  Ключевые выводы:

####  Победитель: Random Forest

- **R²**: 0.7608 (объясняет 76.08% дисперсии)
- **Средняя ошибка**: $39,835 (19% от средней стоимости)
- **Улучшение**: 
  - На 40.5% лучше по RMSE, чем линейная регрессия со всеми признаками
  - На 26.1% лучше по MAE
  - На +0.1420 по R², чем линейная регрессия с числовыми признаками

####  Неожиданный результат:
- Линейная регрессия со всеми признаками показала **худшие** результаты, чем модель только с числовыми признаками
- **Возможные причины**: мультиколлинеарность после one-hot кодирования, отсутствие регуляризации

####  Бизнес-интерпретация:
- **Random Forest**: Ошибка ±$39,835 - подходит для точных оценок
- **Линейная регрессия (числовые)**: Ошибка ±$53,059 - для быстрых оценок
- **Линейная регрессия (все признаки)**: Требует доработки

## Технологический стек

**Apache Spark** | 3.x/2.x | Распределенная обработка данных  
**PySpark** | 3.1+ | Python API для Spark  
**PySpark MLlib** | - | Библиотека машинного обучения  
**Python** | 3.9+ | Основной язык программирования  
**Jupyter Notebook** | - | Интерактивная среда разработки

### Основные библиотеки PySpark:
- `pyspark.sql` - работа с DataFrames
- `pyspark.ml.feature` - преобразование признаков
- `pyspark.ml.regression` - модели регрессии
- `pyspark.ml.evaluation` - оценка моделей

## Метрики эффективности

###  Метрики качества моделей:
- **RMSE**: Root Mean Square Error (среднеквадратичная ошибка)
- **MAE**: Mean Absolute Error (средняя абсолютная ошибка)
- **R²**: Coefficient of Determination (коэффициент детерминации)

###  Обработка данных:
- **Заполнение пропусков**: 207 пропусков в `total_bedrooms` (1%)
- **Кодирование категорий**: One-hot encoding для `ocean_proximity`
- **Масштабирование**: StandardScaler для числовых признаков
- **Разделение**: 80/20 на обучающую и тестовую выборки

###  Воспроизводимость:
- **Seed**: 2022 для случайных процессов
- **Версионность**: Поддержка Spark 2 и 3
- **Конвейер**: Полный пайплайн обработки данных

## Рекомендации для практического применения

### Для риелторов и агентств:
1. **Автоматизация оценки**: Использовать Random Forest для быстрой оценки объектов
2. **Риск-менеджмент**: Учитывать погрешность ±$39,835 при ценообразовании
3. **Сегментация рынка**: Анализ влияния географических и демографических факторов

### Для инвесторов:
1. **Выявление потенциала**: Идентификация районов с недооцененной недвижимостью
2. **Прогнозирование роста**: Анализ факторов, влияющих на стоимость
3. **Диверсификация**: Оценка рисков по географическим регионам

### Для банков:
1. **Ипотечное кредитование**: Точная оценка залоговой стоимости
2. **Риск-менеджмент**: Прогнозирование изменений стоимости недвижимости
3. **Автоматизация**: Интеграция модели в кредитные процессы


## Выявленные проблемы и решения

###  Проблемы:
1. **Пропуски данных**: 207 пропущенных значений в `total_bedrooms`
2. **Категориальные данные**: Признак `ocean_proximity` требует кодирования
3. **Масштаб признаков**: Сильное различие в масштабах числовых признаков
4. **Новые категории**: Возможность встречи неизвестных значений `ocean_proximity`

###  Решения:
1. **Заполнение средним**: Для `total_bedrooms` использовано среднее значение
2. **StringIndexer + OneHotEncoder**: Двухэтапное кодирование категорий
3. **StandardScaler**: Центрирование и масштабирование числовых признаков
4. **handleInvalid="keep"**: Защита от ошибок при новых категориях

## Бизнес-воздействие

###  Экономический эффект:
- **Снижение ошибок оценки**: Уменьшение погрешности на 40.5%
- **Ускорение процесса**: Автоматизация вместо ручных расчетов
- **Снижение рисков**: Более точная оценка залоговой стоимости

###  Операционные улучшения:
- **Масштабируемость**: Обработка больших объемов данных
- **Стандартизация**: Единый подход к оценке недвижимости
- **Интеграция**: Возможность встраивания в существующие системы

###  Качественные преимущества:
- **Объективность**: Снижение субъективности в оценке
- **Транспарентность**: Объяснимая методика расчета
- **Актуальность**: Возможность регулярного обновления модели

## Навыки и методы

###  Архитектура проекта:
- **Apache Spark**: Распределенная обработка больших данных
- **ML Pipeline**: Полный конвейер от данных до прогнозов
- **Модульность**: Разделение на этапы предобработки и моделирования

###  Технические навыки:
- **Обработка данных**: Работа с пропусками, кодирование категорий
- **Feature Engineering**: Создание и преобразование признаков
- **Масштабирование**: Нормализация числовых признаков
- **Векторизация**: Объединение признаков в feature vector

###  Методы машинного обучения:
- **Линейная регрессия**: Базовый и расширенный варианты
- **Random Forest**: Ансамблевый метод для регрессии
- **Кросс-валидация**: Разделение данных на train/test
- **Метрики оценки**: RMSE, MAE, R² для регрессии


## Заключение

Проект успешно реализовал три различные модели для прогнозирования стоимости жилья в Калифорнии. Наилучшие результаты показала модель Random Forest, которая объясняет 76.08% дисперсии целевой переменной со средней ошибкой $39,835. 

### Ключевые достижения:
 **Высокая точность**: R² = 0.7608 для лучшей модели  
 **Практическая применимость**: Готовое решение для бизнес-задач  
 **Масштабируемость**: Использование Spark для больших данных  
 **Воспроизводимость**: Полный пайплайн с фиксированными seed  


Проект демонстрирует практическую применимость машинного обучения и распределенных вычислений для решения реальных бизнес-задач в сфере недвижимости.


```python

```
