# Прогнозирование продуктивности и качества молока коров с использованием машинного обучения
_______________________
  
  
    
## О проекте
Проект представляет собой комплексное решение для молочного фермерства, использующее машинное обучение для оптимизации процесса отбора коров. Разработаны две взаимодополняющие модели для прогнозирования удоя и классификации вкуса молока.

### Бизнес-контекст:
- **Заказчик**: Фермер владелец молочного хозяйства «Вольный луг»
- **Партнер**: Ассоциация пастбищ «ЭкоФерма»
- **Критерии отбора**:
  - Удой ≥ 6000 кг/год
  - Молоко должно быть "вкусным" по методике фермера
  - Минимизация рисков покупки непродуктивных коров

## Цели проекта
1. **Прогностическая**: Создать модель прогнозирования удоя коров (линейная регрессия)
2. **Классификационная**: Разработать модель оценки вкуса молока (логистическая регрессия)
3. **Бизнес-ориентированная**: Обеспечить объективный отбор коров для покупки
4. **Аналитическая**: Исследовать факторы, влияющие на продуктивность и качество молока
----------

   
## Ключевые результаты
  
### Линейная регрессия (прогноз удоя)
- **Лучшая модель**: R² = 0.8216 (объясняет 82% дисперсии удоя)
- **Метрики финальной модели**:
  - MSE: 36,310
  - MAE: 147 кг
  - RMSE: 191 кг
  - Доверительный интервал: [-407; -234] кг
- **Прогноз для новых коров**: 4,349-4,824 кг (ниже целевого порога 6000 кг)

### Логистическая регрессия (классификация вкуса)
- **Оптимальный порог вероятности**: 0.64
- **Метрики с оптимальным порогом**:
  - Precision: 0.70
  - Recall: 0.38
  - Accuracy: 0.535
- **Отбор коров**: С порогом 0.64 не отобрано ни одной коровы для покупки

### Факторы влияния
- **Сильные корреляции с удоем**:
  - СПО (Сахаро-протеиновое соотношение): 0.81
  - ЭКЕ (Энергетическая кормовая единица): 0.77
  - Жирность молока: 0.60
- **Категориальные особенности**:
  - Преобладает порода "Вис Бик Айдиал" (75%)
  - Возрастная группа "более 2 лет" (75%)
  - 60% молока оценивается как "вкусное"



## Проверенные инсайты

### Влияние преобразования признаков
- Квадратирование ЭКЕ и бинаризация СПО повысили R² на 3.5%

### Значение генетических факторов
- Добавление признака "Имя Папы" улучшило модель на 0.6%

### Бизнес-риски при отборе
- Строгий порог (0.64) минимизирует риски, но снижает доступность
  

## Технологический стек

**Python** | 3.9+ | Основной язык программирования  
**Pandas** | 1.3+ | Обработка и анализ данных  
**NumPy** | 1.21+ | Математические вычисления  
**Matplotlib** | 3.5+ | Построение графиков  
**Seaborn** | 0.11+ | Статистическая визуализация  
**Scikit-learn** | 1.0+ | Машинное обучение  
**Jupyter Notebook** | - | Интерактивная среда разработки
  
### Библиотеки машинного обучения:
- **LinearRegression** | Прогнозирование удоя
- **LogisticRegression** | Классификация вкуса
- **StandardScaler** | Масштабирование признаков
- **OneHotEncoder** | Кодирование категориальных признаков
- **train_test_split** | Разделение данных

## Метрики эффективности
- **Качество регрессии**: R² = 0.8216
- **Качество классификации**: Precision = 0.70 при Recall = 0.38
- **Бизнес-метрика**: 0 отобранных коров при строгих критериях
- **Стабильность модели**: Систематическое завышение прогнозов на ~300 кг

  

## Рекомендации для фермера

### Стратегия отбора:
1. **Строгий подход (минимальный риск)**: Использовать порог 0.64 - 0 отобранных коров
2. **Умеренный подход (сделка важна)**: Снизить порог до 0.35-0.46 - риск ошибки 30-40%
3. **Альтернативный подход**: Выбрать топ-N коров по вероятности вкусного молока

### Управление стадом:
1. **Генетический отбор**: Учитывать породу быков-отцов при разведении
2. **Оптимизация кормления**: Поддерживать СПО ~0.9 и оптимальный уровень ЭКЕ
3. **Возрастная политика**: Баланс между взрослыми (>2 лет) и молодыми коровами

### Экономические решения:
1. **Пересмотр критериев**: Возможно, требование 6000 кг слишком высоко для новых коров
2. **Дополнительные данные**: Запросить больше информации у "ЭкоФермы"
3. **Тестовый период**: Рассмотреть возможность тестового содержания перед покупкой
   
### Развитие системы:
1. **Сбор данных**: Дополнительная информация о здоровье и условиях содержания
2. **Адаптивные пороги**: Система автоматической настройки порогов в зависимости от рыночной ситуации
3. **Регулярное обновление**: Включение новых данных в модели

## Выявленные проблемы и решения

### Проблемы:
1. **Несоответствие критериям**: Прогнозируемый удой новых коров ниже целевого порога
2. **Ограниченность данных**: Отсутствие информации о здоровье и условиях содержания
3. **Различия в данных**: Новые коровы имеют другие характеристики vs существующее стадо

### Решения:
1. **Калибровка модели**: Коррекция систематической ошибки
2. **Запрос дополнительных данных**: Уточнение у "ЭкоФермы"
3. **Адаптация порогов**: Гибкая настройка под текущую ситуацию
4. **Тестирование альтернативных моделей**: Ансамблевые методы, другие алгоритмы

## Бизнес-воздействие
- **Снижение рисков**: Минимизация покупки непродуктивных коров
- **Повышение точности**: Прогнозирование удоя с 82% объяснённой дисперсией
- **Объективность отбора**: Устранение субъективных оценок
- **Долгосрочная эффективность**: Создание основы для data-driven управления

## Навыки и методы
- **Линейная регрессия**: Прогнозирование непрерывных значений
- **Логистическая регрессия**: Бинарная классификация
- **Преобразование признаков**: Квадратирование, бинаризация
- **Оценка моделей**: R², MSE, MAE, RMSE, Precision, Recall
- **Визуализация**: Гистограммы, диаграммы рассеяния, тепловые карты
- **Предобработка данных**: Очистка, унификация, масштабирование


```python

```
